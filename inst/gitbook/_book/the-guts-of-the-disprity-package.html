<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 The guts of the dispRity package | dispRity R package manual</title>
  <meta name="description" content="7 The guts of the dispRity package | dispRity R package manual" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="7 The guts of the dispRity package | dispRity R package manual" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="7 The guts of the dispRity package | dispRity R package manual" />
  <meta name="github-repo" content="TGuillerme/dispRity" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 The guts of the dispRity package | dispRity R package manual" />
  
  <meta name="twitter:description" content="7 The guts of the dispRity package | dispRity R package manual" />
  

<meta name="author" content="Thomas Guillerme (guillert@tcd.ie)" />


<meta name="date" content="2024-03-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="other-functionalities.html"/>
<link rel="next" href="disprity-ecology-demo.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/rglWebGL-binding-1.2.8/rglWebGL.js"></script>
<link href="libs/rglwidgetClass-1.2.8/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-1.2.8/rglClass.src.js"></script>
<script src="libs/rglwidgetClass-1.2.8/utils.src.js"></script>
<script src="libs/rglwidgetClass-1.2.8/buffer.src.js"></script>
<script src="libs/rglwidgetClass-1.2.8/subscenes.src.js"></script>
<script src="libs/rglwidgetClass-1.2.8/shaders.src.js"></script>
<script src="libs/rglwidgetClass-1.2.8/shadersrc.src.js"></script>
<script src="libs/rglwidgetClass-1.2.8/textures.src.js"></script>
<script src="libs/rglwidgetClass-1.2.8/projection.src.js"></script>
<script src="libs/rglwidgetClass-1.2.8/mouse.src.js"></script>
<script src="libs/rglwidgetClass-1.2.8/init.src.js"></script>
<script src="libs/rglwidgetClass-1.2.8/pieces.src.js"></script>
<script src="libs/rglwidgetClass-1.2.8/draw.src.js"></script>
<script src="libs/rglwidgetClass-1.2.8/controls.src.js"></script>
<script src="libs/rglwidgetClass-1.2.8/selection.src.js"></script>
<script src="libs/rglwidgetClass-1.2.8/rglTimer.src.js"></script>
<script src="libs/rglwidgetClass-1.2.8/pretty.src.js"></script>
<script src="libs/rglwidgetClass-1.2.8/axes.src.js"></script>
<script src="libs/rglwidgetClass-1.2.8/animation.src.js"></script>
<script src="libs/CanvasMatrix4-1.2.8/CanvasMatrix.src.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">dispRity manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> <code>dispRity</code></a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#what-is-disprity"><i class="fa fa-check"></i><b>1.1</b> What is <code>dispRity</code>?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#modular"><i class="fa fa-check"></i><b>1.1.1</b> Modular?</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installing-and-running-the-package"><i class="fa fa-check"></i><b>1.2</b> Installing and running the package</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#version"><i class="fa fa-check"></i><b>1.3</b> Which version do I choose?</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#disprity-is-always-changing-how-do-i-know-its-not-broken"><i class="fa fa-check"></i><b>1.4</b> <code>dispRity</code> is always changing, how do I know it’s not broken?</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#help"><i class="fa fa-check"></i><b>1.5</b> Help</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#citations"><i class="fa fa-check"></i><b>1.6</b> Citations</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="index.html"><a href="index.html#why-is-it-important-to-cite-us"><i class="fa fa-check"></i><b>1.6.1</b> Why is it important to cite us?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="glossary.html"><a href="glossary.html"><i class="fa fa-check"></i><b>2</b> Glossary</a>
<ul>
<li class="chapter" data-level="2.1" data-path="glossary.html"><a href="glossary.html#glossary-equivalences-in-palaeobiology-and-ecology"><i class="fa fa-check"></i><b>2.1</b> Glossary equivalences in palaeobiology and ecology</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="getting-started-with-disprity.html"><a href="getting-started-with-disprity.html"><i class="fa fa-check"></i><b>3</b> Getting started with <code>dispRity</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="getting-started-with-disprity.html"><a href="getting-started-with-disprity.html#what-sort-of-data-does-disprity-work-with"><i class="fa fa-check"></i><b>3.1</b> What sort of data does <code>dispRity</code> work with?</a></li>
<li class="chapter" data-level="3.2" data-path="getting-started-with-disprity.html"><a href="getting-started-with-disprity.html#ordinated-matrices"><i class="fa fa-check"></i><b>3.2</b> Ordinated matrices</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="getting-started-with-disprity.html"><a href="getting-started-with-disprity.html#ordination-matrices-from-geomorph"><i class="fa fa-check"></i><b>3.2.1</b> Ordination matrices from <code>geomorph</code></a></li>
<li class="chapter" data-level="3.2.2" data-path="getting-started-with-disprity.html"><a href="getting-started-with-disprity.html#Claddis-ordination"><i class="fa fa-check"></i><b>3.2.2</b> Ordination matrices from <code>Claddis</code></a></li>
<li class="chapter" data-level="3.2.3" data-path="getting-started-with-disprity.html"><a href="getting-started-with-disprity.html#other-kinds-of-ordination-matrices"><i class="fa fa-check"></i><b>3.2.3</b> Other kinds of ordination matrices</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="getting-started-with-disprity.html"><a href="getting-started-with-disprity.html#simpleanalysis"><i class="fa fa-check"></i><b>3.3</b> Performing a simple dispRity analysis</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="getting-started-with-disprity.html"><a href="getting-started-with-disprity.html#example-data"><i class="fa fa-check"></i><b>3.3.1</b> Example data</a></li>
<li class="chapter" data-level="3.3.2" data-path="getting-started-with-disprity.html"><a href="getting-started-with-disprity.html#disparity-through-time"><i class="fa fa-check"></i><b>3.3.2</b> Disparity through time</a></li>
<li class="chapter" data-level="3.3.3" data-path="getting-started-with-disprity.html"><a href="getting-started-with-disprity.html#disparity-among-groups"><i class="fa fa-check"></i><b>3.3.3</b> Disparity among groups</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html"><i class="fa fa-check"></i><b>4</b> Details of specific functions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#chrono-subsets"><i class="fa fa-check"></i><b>4.1</b> Time slicing</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#time-binning"><i class="fa fa-check"></i><b>4.1.1</b> Time-binning</a></li>
<li class="chapter" data-level="4.1.2" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#time-slicing"><i class="fa fa-check"></i><b>4.1.2</b> Time-slicing</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#custom-subsets"><i class="fa fa-check"></i><b>4.2</b> Customised subsets</a></li>
<li class="chapter" data-level="4.3" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#bootstraps-and-rarefactions"><i class="fa fa-check"></i><b>4.3</b> Bootstraps and rarefactions</a></li>
<li class="chapter" data-level="4.4" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#disparity-metrics"><i class="fa fa-check"></i><b>4.4</b> Disparity metrics</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#the-function-dimension-levels"><i class="fa fa-check"></i><b>4.4.1</b> The function dimension-levels</a></li>
<li class="chapter" data-level="4.4.2" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#betweengroupmetricsexplain"><i class="fa fa-check"></i><b>4.4.2</b> Between groups metrics</a></li>
<li class="chapter" data-level="4.4.3" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#makemetric"><i class="fa fa-check"></i><b>4.4.3</b> <code>make.metric</code></a></li>
<li class="chapter" data-level="4.4.4" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#metrics-in-the-disprity-function"><i class="fa fa-check"></i><b>4.4.4</b> Metrics in the <code>dispRity</code> function</a></li>
<li class="chapter" data-level="4.4.5" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#metrics-implemented-in-disprity"><i class="fa fa-check"></i><b>4.4.5</b> Metrics implemented in <code>dispRity</code></a></li>
<li class="chapter" data-level="4.4.6" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#equations-and-implementations"><i class="fa fa-check"></i><b>4.4.6</b> Equations and implementations</a></li>
<li class="chapter" data-level="4.4.7" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#using-the-different-disparity-metrics"><i class="fa fa-check"></i><b>4.4.7</b> Using the different disparity metrics</a></li>
<li class="chapter" data-level="4.4.8" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#which-disparity-metric-to-choose"><i class="fa fa-check"></i><b>4.4.8</b> Which disparity metric to choose?</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#summarising-disprity-data-plots"><i class="fa fa-check"></i><b>4.5</b> Summarising dispRity data (plots)</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#summarising-disprity-data"><i class="fa fa-check"></i><b>4.5.1</b> Summarising <code>dispRity</code> data</a></li>
<li class="chapter" data-level="4.5.2" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#plotting-disprity-data"><i class="fa fa-check"></i><b>4.5.2</b> Plotting <code>dispRity</code> data</a></li>
<li class="chapter" data-level="4.5.3" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#type-preview"><i class="fa fa-check"></i><b>4.5.3</b> <code>type = preview</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#graphical-options-with-..."><i class="fa fa-check"></i><b>4.5.4</b> Graphical options with <code>...</code></a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#testing-disparity-hypotheses"><i class="fa fa-check"></i><b>4.6</b> Testing disparity hypotheses</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#adonis"><i class="fa fa-check"></i><b>4.6.1</b> NPMANOVA in <code>dispRity</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#dtt"><i class="fa fa-check"></i><b>4.6.2</b> <code>geiger::dtt</code> model fitting in <code>dispRity</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#null-test"><i class="fa fa-check"></i><b>4.6.3</b> null morphospace testing with <code>null.test</code></a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#model-fitting"><i class="fa fa-check"></i><b>4.7</b> Fitting modes of evolution to disparity data</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#simple-modes-of-disparity-change-through-time"><i class="fa fa-check"></i><b>4.7.1</b> Simple modes of disparity change through time</a></li>
<li class="chapter" data-level="4.7.2" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#plot-and-run-simulation-tests-in-a-single-step"><i class="fa fa-check"></i><b>4.7.2</b> Plot and run simulation tests in a single step</a></li>
<li class="chapter" data-level="4.7.3" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#multiple-modes-of-evolution-time-shifts"><i class="fa fa-check"></i><b>4.7.3</b> Multiple modes of evolution (time shifts)</a></li>
<li class="chapter" data-level="4.7.4" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#model.test.sim"><i class="fa fa-check"></i><b>4.7.4</b> <code>model.test.sim</code></a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#disparity-distribution"><i class="fa fa-check"></i><b>4.8</b> Disparity as a distribution</a></li>
<li class="chapter" data-level="4.9" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#other-matrices"><i class="fa fa-check"></i><b>4.9</b> Disparity from other matrices</a></li>
<li class="chapter" data-level="4.10" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#multi.input"><i class="fa fa-check"></i><b>4.10</b> Disparity from multiple matrices (and multiple trees!)</a></li>
<li class="chapter" data-level="4.11" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#dispRitree"><i class="fa fa-check"></i><b>4.11</b> Disparity with trees: <em>dispRitree!</em></a></li>
<li class="chapter" data-level="4.12" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#covar"><i class="fa fa-check"></i><b>4.12</b> Disparity of variance-covariance matrices (covar)</a>
<ul>
<li class="chapter" data-level="4.12.1" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#creating-a-disprity-object-with-a-covar-component"><i class="fa fa-check"></i><b>4.12.1</b> Creating a <code>dispRity</code> object with a <code>$covar</code> component</a></li>
<li class="chapter" data-level="4.12.2" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#visualising-covar-objects"><i class="fa fa-check"></i><b>4.12.2</b> Visualising covar objects</a></li>
<li class="chapter" data-level="4.12.3" data-path="details-of-specific-functions.html"><a href="details-of-specific-functions.html#disparity-analyses-with-a-covar-component"><i class="fa fa-check"></i><b>4.12.3</b> Disparity analyses with a <code>$covar</code> component</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="making-stuff-up.html"><a href="making-stuff-up.html"><i class="fa fa-check"></i><b>5</b> Making stuff up!</a>
<ul>
<li class="chapter" data-level="5.1" data-path="making-stuff-up.html"><a href="making-stuff-up.html#simulating-discrete-morphological-data"><i class="fa fa-check"></i><b>5.1</b> Simulating discrete morphological data</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="making-stuff-up.html"><a href="making-stuff-up.html#a-more-detailed-description"><i class="fa fa-check"></i><b>5.1.1</b> A more detailed description</a></li>
<li class="chapter" data-level="5.1.2" data-path="making-stuff-up.html"><a href="making-stuff-up.html#parameters-for-a-realisticish-matrix"><i class="fa fa-check"></i><b>5.1.2</b> Parameters for a realistic(ish) matrix</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="making-stuff-up.html"><a href="making-stuff-up.html#simulating-multidimensional-spaces"><i class="fa fa-check"></i><b>5.2</b> Simulating multidimensional spaces</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="making-stuff-up.html"><a href="making-stuff-up.html#personalised-dimensions-distributions"><i class="fa fa-check"></i><b>5.2.1</b> Personalised dimensions distributions</a></li>
<li class="chapter" data-level="5.2.2" data-path="making-stuff-up.html"><a href="making-stuff-up.html#visualising-the-space"><i class="fa fa-check"></i><b>5.2.2</b> Visualising the space</a></li>
<li class="chapter" data-level="5.2.3" data-path="making-stuff-up.html"><a href="making-stuff-up.html#generating-realistic-spaces"><i class="fa fa-check"></i><b>5.2.3</b> Generating realistic spaces</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="other-functionalities.html"><a href="other-functionalities.html"><i class="fa fa-check"></i><b>6</b> Other functionalities</a>
<ul>
<li class="chapter" data-level="6.1" data-path="other-functionalities.html"><a href="other-functionalities.html#char.diff"><i class="fa fa-check"></i><b>6.1</b> <code>char.diff</code></a></li>
<li class="chapter" data-level="6.2" data-path="other-functionalities.html"><a href="other-functionalities.html#clean.data"><i class="fa fa-check"></i><b>6.2</b> <code>clean.data</code></a></li>
<li class="chapter" data-level="6.3" data-path="other-functionalities.html"><a href="other-functionalities.html#crown.stem"><i class="fa fa-check"></i><b>6.3</b> <code>crown.stem</code></a></li>
<li class="chapter" data-level="6.4" data-path="other-functionalities.html"><a href="other-functionalities.html#get.bin.ages"><i class="fa fa-check"></i><b>6.4</b> <code>get.bin.ages</code></a></li>
<li class="chapter" data-level="6.5" data-path="other-functionalities.html"><a href="other-functionalities.html#match.tip.edge"><i class="fa fa-check"></i><b>6.5</b> <code>match.tip.edge</code></a></li>
<li class="chapter" data-level="6.6" data-path="other-functionalities.html"><a href="other-functionalities.html#MCMCglmm-utilities"><i class="fa fa-check"></i><b>6.6</b> <code>MCMCglmm</code> utilities</a></li>
<li class="chapter" data-level="6.7" data-path="other-functionalities.html"><a href="other-functionalities.html#pair.plot"><i class="fa fa-check"></i><b>6.7</b> <code>pair.plot</code></a></li>
<li class="chapter" data-level="6.8" data-path="other-functionalities.html"><a href="other-functionalities.html#reduce.matrix"><i class="fa fa-check"></i><b>6.8</b> <code>reduce.matrix</code></a></li>
<li class="chapter" data-level="6.9" data-path="other-functionalities.html"><a href="other-functionalities.html#select.axes"><i class="fa fa-check"></i><b>6.9</b> <code>select.axes</code></a></li>
<li class="chapter" data-level="6.10" data-path="other-functionalities.html"><a href="other-functionalities.html#set.root.time"><i class="fa fa-check"></i><b>6.10</b> <code>set.root.time</code></a></li>
<li class="chapter" data-level="6.11" data-path="other-functionalities.html"><a href="other-functionalities.html#slice.tree"><i class="fa fa-check"></i><b>6.11</b> <code>slice.tree</code></a></li>
<li class="chapter" data-level="6.12" data-path="other-functionalities.html"><a href="other-functionalities.html#slide.nodes-and-remove.zero.brlen"><i class="fa fa-check"></i><b>6.12</b> <code>slide.nodes</code> and <code>remove.zero.brlen</code></a></li>
<li class="chapter" data-level="6.13" data-path="other-functionalities.html"><a href="other-functionalities.html#tree.age"><i class="fa fa-check"></i><b>6.13</b> <code>tree.age</code></a></li>
<li class="chapter" data-level="6.14" data-path="other-functionalities.html"><a href="other-functionalities.html#multi.ace"><i class="fa fa-check"></i><b>6.14</b> <code>multi.ace</code></a>
<ul>
<li class="chapter" data-level="6.14.1" data-path="other-functionalities.html"><a href="other-functionalities.html#using-different-character-tokens-in-different-situations"><i class="fa fa-check"></i><b>6.14.1</b> Using different character tokens in different situations</a></li>
<li class="chapter" data-level="6.14.2" data-path="other-functionalities.html"><a href="other-functionalities.html#feeding-the-results-to-char.diff-to-get-distance-matrices"><i class="fa fa-check"></i><b>6.14.2</b> Feeding the results to <code>char.diff</code> to get distance matrices</a></li>
<li class="chapter" data-level="6.14.3" data-path="other-functionalities.html"><a href="other-functionalities.html#running-ancestral-states-estimations-for-continuous-characters"><i class="fa fa-check"></i><b>6.14.3</b> Running ancestral states estimations for continuous characters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="the-guts-of-the-disprity-package.html"><a href="the-guts-of-the-disprity-package.html"><i class="fa fa-check"></i><b>7</b> The guts of the <code>dispRity</code> package</a>
<ul>
<li class="chapter" data-level="7.1" data-path="the-guts-of-the-disprity-package.html"><a href="the-guts-of-the-disprity-package.html#manipulating-disprity-objects"><i class="fa fa-check"></i><b>7.1</b> Manipulating <code>dispRity</code> objects</a></li>
<li class="chapter" data-level="7.2" data-path="the-guts-of-the-disprity-package.html"><a href="the-guts-of-the-disprity-package.html#utilities"><i class="fa fa-check"></i><b>7.2</b> <code>dispRity</code> utilities</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="the-guts-of-the-disprity-package.html"><a href="the-guts-of-the-disprity-package.html#disprity-object-utilities"><i class="fa fa-check"></i><b>7.2.1</b> <code>dispRity</code> object utilities <a name="dispRity.utilities"></a></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="the-guts-of-the-disprity-package.html"><a href="the-guts-of-the-disprity-package.html#disprity-object"><i class="fa fa-check"></i><b>7.3</b> The <code>dispRity</code> object content</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="the-guts-of-the-disprity-package.html"><a href="the-guts-of-the-disprity-package.html#matrix"><i class="fa fa-check"></i><b>7.3.1</b> <code>$matrix</code></a></li>
<li class="chapter" data-level="7.3.2" data-path="the-guts-of-the-disprity-package.html"><a href="the-guts-of-the-disprity-package.html#call"><i class="fa fa-check"></i><b>7.3.2</b> <code>$call</code></a></li>
<li class="chapter" data-level="7.3.3" data-path="the-guts-of-the-disprity-package.html"><a href="the-guts-of-the-disprity-package.html#subsets"><i class="fa fa-check"></i><b>7.3.3</b> <code>$subsets</code></a></li>
<li class="chapter" data-level="7.3.4" data-path="the-guts-of-the-disprity-package.html"><a href="the-guts-of-the-disprity-package.html#disparity"><i class="fa fa-check"></i><b>7.3.4</b> <code>$disparity</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="disprity-ecology-demo.html"><a href="disprity-ecology-demo.html"><i class="fa fa-check"></i><b>8</b> dispRity ecology demo</a>
<ul>
<li class="chapter" data-level="8.1" data-path="disprity-ecology-demo.html"><a href="disprity-ecology-demo.html#data"><i class="fa fa-check"></i><b>8.1</b> Data</a></li>
<li class="chapter" data-level="8.2" data-path="disprity-ecology-demo.html"><a href="disprity-ecology-demo.html#classic-analysis"><i class="fa fa-check"></i><b>8.2</b> Classic analysis</a></li>
<li class="chapter" data-level="8.3" data-path="disprity-ecology-demo.html"><a href="disprity-ecology-demo.html#a-multidimensional-approach-with-disprity"><i class="fa fa-check"></i><b>8.3</b> A multidimensional approach with <code>dispRity</code></a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="disprity-ecology-demo.html"><a href="disprity-ecology-demo.html#bootstrapping-the-data"><i class="fa fa-check"></i><b>8.3.1</b> Bootstrapping the data</a></li>
<li class="chapter" data-level="8.3.2" data-path="disprity-ecology-demo.html"><a href="disprity-ecology-demo.html#calculating-disparity"><i class="fa fa-check"></i><b>8.3.2</b> Calculating disparity</a></li>
<li class="chapter" data-level="8.3.3" data-path="disprity-ecology-demo.html"><a href="disprity-ecology-demo.html#summarising-the-results-plot"><i class="fa fa-check"></i><b>8.3.3</b> Summarising the results (plot)</a></li>
<li class="chapter" data-level="8.3.4" data-path="disprity-ecology-demo.html"><a href="disprity-ecology-demo.html#testing-hypothesis"><i class="fa fa-check"></i><b>8.3.4</b> Testing hypothesis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html"><i class="fa fa-check"></i><b>9</b> Palaeobiology demo: disparity-through-time and within groups</a>
<ul>
<li class="chapter" data-level="9.1" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html#before-starting"><i class="fa fa-check"></i><b>9.1</b> Before starting</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html#the-morphospace"><i class="fa fa-check"></i><b>9.1.1</b> The morphospace</a></li>
<li class="chapter" data-level="9.1.2" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html#setting-up-your-own-data"><i class="fa fa-check"></i><b>9.1.2</b> Setting up your own data</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html#a-disparity-through-time-analysis"><i class="fa fa-check"></i><b>9.2</b> A disparity-through-time analysis</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html#splitting-the-morphospace-through-time"><i class="fa fa-check"></i><b>9.2.1</b> Splitting the morphospace through time</a></li>
<li class="chapter" data-level="9.2.2" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html#bootstrapping-the-data-1"><i class="fa fa-check"></i><b>9.2.2</b> Bootstrapping the data</a></li>
<li class="chapter" data-level="9.2.3" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html#calculating-disparity-1"><i class="fa fa-check"></i><b>9.2.3</b> Calculating disparity</a></li>
<li class="chapter" data-level="9.2.4" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html#plotting-the-results"><i class="fa fa-check"></i><b>9.2.4</b> Plotting the results</a></li>
<li class="chapter" data-level="9.2.5" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html#testing-differences"><i class="fa fa-check"></i><b>9.2.5</b> Testing differences</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="palaeobiology-demo-disparity-through-time-and-within-groups.html"><a href="palaeobiology-demo-disparity-through-time-and-within-groups.html#some-more-advanced-stuff"><i class="fa fa-check"></i><b>9.3</b> Some more advanced stuff</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="morphometric-geometric-demo-a-between-group-analysis.html"><a href="morphometric-geometric-demo-a-between-group-analysis.html"><i class="fa fa-check"></i><b>10</b> Morphometric geometric demo: a between group analysis</a>
<ul>
<li class="chapter" data-level="10.1" data-path="morphometric-geometric-demo-a-between-group-analysis.html"><a href="morphometric-geometric-demo-a-between-group-analysis.html#before-starting-1"><i class="fa fa-check"></i><b>10.1</b> Before starting</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="morphometric-geometric-demo-a-between-group-analysis.html"><a href="morphometric-geometric-demo-a-between-group-analysis.html#the-morphospace-1"><i class="fa fa-check"></i><b>10.1.1</b> The morphospace</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="morphometric-geometric-demo-a-between-group-analysis.html"><a href="morphometric-geometric-demo-a-between-group-analysis.html#calculating-disparity-2"><i class="fa fa-check"></i><b>10.2</b> Calculating disparity</a></li>
<li class="chapter" data-level="10.3" data-path="morphometric-geometric-demo-a-between-group-analysis.html"><a href="morphometric-geometric-demo-a-between-group-analysis.html#analyse-the-results"><i class="fa fa-check"></i><b>10.3</b> Analyse the results</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="disprity-r-package-manual.html"><a href="disprity-r-package-manual.html"><i class="fa fa-check"></i><b>11</b> dispRity R package manual</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="12" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i><b>12</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/TGuillerme/dispRity/" target="blank">Project GitHub page</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">dispRity R package manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-guts-of-the-disprity-package" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">7</span> The guts of the <code>dispRity</code> package<a href="the-guts-of-the-disprity-package.html#the-guts-of-the-disprity-package" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="manipulating-disprity-objects" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Manipulating <code>dispRity</code> objects<a href="the-guts-of-the-disprity-package.html#manipulating-disprity-objects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Disparity analysis involves a lot of manipulation of many matrices (especially when bootstrapping) which can be impractical to visualise and will quickly overwhelm your <code>R</code> console.
Even the simple Beck and Lee 2014 example above produces an object with &gt; 72 lines of lists of lists of matrices!</p>
<p>Therefore <code>dispRity</code> uses a specific class of object called a <code>dispRity</code> object.
These objects allow users to use S3 method functions such as <code>summary.dispRity</code>, <code>plot.dispRity</code> and <code>print.dispRity</code>.
<code>dispRity</code> also contains various utility functions that manipulate the <code>dispRity</code> object (e.g. <code>sort.dispRity</code>, <code>extract.dispRity</code> see the full list in the next section).
These functions modify the <code>dispRity</code> object without having to delve into its complex structure!
The full structure of a <code>dispRity</code> object is detailed <a href="https://github.com/TGuillerme/dispRity/blob/master/disparity_object.md">here</a>.</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="the-guts-of-the-disprity-package.html#cb545-1" aria-hidden="true"></a><span class="co">## Loading the example data</span></span>
<span id="cb545-2"><a href="the-guts-of-the-disprity-package.html#cb545-2" aria-hidden="true"></a><span class="kw">data</span>(disparity)</span>
<span id="cb545-3"><a href="the-guts-of-the-disprity-package.html#cb545-3" aria-hidden="true"></a></span>
<span id="cb545-4"><a href="the-guts-of-the-disprity-package.html#cb545-4" aria-hidden="true"></a><span class="co">## What is the class of the median_centroids object?</span></span>
<span id="cb545-5"><a href="the-guts-of-the-disprity-package.html#cb545-5" aria-hidden="true"></a><span class="kw">class</span>(disparity)</span></code></pre></div>
<pre><code>## [1] &quot;dispRity&quot;</code></pre>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="the-guts-of-the-disprity-package.html#cb547-1" aria-hidden="true"></a><span class="co">## What does the object contain?</span></span>
<span id="cb547-2"><a href="the-guts-of-the-disprity-package.html#cb547-2" aria-hidden="true"></a><span class="kw">names</span>(disparity)</span></code></pre></div>
<pre><code>## [1] &quot;matrix&quot;    &quot;tree&quot;      &quot;call&quot;      &quot;subsets&quot;   &quot;disparity&quot;</code></pre>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="the-guts-of-the-disprity-package.html#cb549-1" aria-hidden="true"></a><span class="co">## Summarising it using the S3 method print.dispRity</span></span>
<span id="cb549-2"><a href="the-guts-of-the-disprity-package.html#cb549-2" aria-hidden="true"></a>disparity</span></code></pre></div>
<pre><code>##  ---- dispRity object ---- 
## 7 continuous (acctran) time subsets for 99 elements in one matrix with 97 dimensions with 1 phylogenetic tree
##      90, 80, 70, 60, 50 ...
## Data was bootstrapped 100 times (method:&quot;full&quot;) and rarefied to 20, 15, 10, 5 elements.
## Disparity was calculated as: c(median, centroids).</code></pre>
<p>Note that it is always possible to recall the full object using the argument <code>all = TRUE</code> in <code>print.dispRity</code>:</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="the-guts-of-the-disprity-package.html#cb551-1" aria-hidden="true"></a><span class="co">## Display the full object</span></span>
<span id="cb551-2"><a href="the-guts-of-the-disprity-package.html#cb551-2" aria-hidden="true"></a><span class="kw">print</span>(disparity, <span class="dt">all =</span> <span class="ot">TRUE</span>)</span>
<span id="cb551-3"><a href="the-guts-of-the-disprity-package.html#cb551-3" aria-hidden="true"></a><span class="co">## This is more nearly ~ 5000 lines on my 13 inch laptop screen!</span></span></code></pre></div>
</div>
<div id="utilities" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> <code>dispRity</code> utilities<a href="the-guts-of-the-disprity-package.html#utilities" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The package also provides some utility functions to facilitate multidimensional analysis.</p>
<div id="disprity-object-utilities" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> <code>dispRity</code> object utilities <a name="dispRity.utilities"></a><a href="the-guts-of-the-disprity-package.html#disprity-object-utilities" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first set of utilities are functions for manipulating <code>dispRity</code> objects:</p>
<div id="make.disprity" class="section level4 hasAnchor" number="7.2.1.1">
<h4><span class="header-section-number">7.2.1.1</span> <code>make.dispRity</code><a href="the-guts-of-the-disprity-package.html#make.disprity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This function creates empty <code>dispRity</code> objects.</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="the-guts-of-the-disprity-package.html#cb552-1" aria-hidden="true"></a><span class="co">## Creating an empty dispRity object</span></span>
<span id="cb552-2"><a href="the-guts-of-the-disprity-package.html#cb552-2" aria-hidden="true"></a><span class="kw">make.dispRity</span>()</span></code></pre></div>
<pre><code>## Empty dispRity object.</code></pre>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="the-guts-of-the-disprity-package.html#cb554-1" aria-hidden="true"></a><span class="co">## Creating an &quot;empty&quot; dispRity object with a matrix</span></span>
<span id="cb554-2"><a href="the-guts-of-the-disprity-package.html#cb554-2" aria-hidden="true"></a>(disparity_obj &lt;-<span class="st"> </span><span class="kw">make.dispRity</span>(<span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">20</span>), <span class="dv">5</span>, <span class="dv">4</span>)))</span></code></pre></div>
<pre><code>##  ---- dispRity object ---- 
## Contains a matrix 5x4.</code></pre>
</div>
<div id="fill.disprity" class="section level4 hasAnchor" number="7.2.1.2">
<h4><span class="header-section-number">7.2.1.2</span> <code>fill.dispRity</code><a href="the-guts-of-the-disprity-package.html#fill.disprity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This function initialises a <code>dispRity</code> object and generates its call properties.</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="the-guts-of-the-disprity-package.html#cb556-1" aria-hidden="true"></a><span class="co">## The dispRity object&#39;s call is indeed empty</span></span>
<span id="cb556-2"><a href="the-guts-of-the-disprity-package.html#cb556-2" aria-hidden="true"></a>disparity_obj<span class="op">$</span>call</span></code></pre></div>
<pre><code>## list()</code></pre>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="the-guts-of-the-disprity-package.html#cb558-1" aria-hidden="true"></a><span class="co">## Filling an empty disparity object (that needs to contain at least a matrix)</span></span>
<span id="cb558-2"><a href="the-guts-of-the-disprity-package.html#cb558-2" aria-hidden="true"></a>(disparity_obj &lt;-<span class="st"> </span><span class="kw">fill.dispRity</span>(disparity_obj))</span></code></pre></div>
<pre><code>## Warning in check.data(data, match_call): Row names have been automatically
## added to data$matrix.</code></pre>
<pre><code>##  ---- dispRity object ---- 
## 5 elements in one matrix with 4 dimensions.</code></pre>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="the-guts-of-the-disprity-package.html#cb561-1" aria-hidden="true"></a><span class="co">## The dipRity object has now the correct minimal attributes</span></span>
<span id="cb561-2"><a href="the-guts-of-the-disprity-package.html#cb561-2" aria-hidden="true"></a>disparity_obj<span class="op">$</span>call</span></code></pre></div>
<pre><code>## $dimensions
## [1] 1 2 3 4</code></pre>
</div>
<div id="get.matrix" class="section level4 hasAnchor" number="7.2.1.3">
<h4><span class="header-section-number">7.2.1.3</span> <code>get.matrix</code><a href="the-guts-of-the-disprity-package.html#get.matrix" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This function extracts a specific matrix from a disparity object.
The matrix can be one of the bootstrapped matrices or/and a rarefied matrix.</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="the-guts-of-the-disprity-package.html#cb563-1" aria-hidden="true"></a><span class="co">## Extracting the matrix containing the coordinates of the elements at time 50</span></span>
<span id="cb563-2"><a href="the-guts-of-the-disprity-package.html#cb563-2" aria-hidden="true"></a><span class="kw">str</span>(<span class="kw">get.matrix</span>(disparity, <span class="st">&quot;50&quot;</span>))</span></code></pre></div>
<pre><code>##  num [1:18, 1:97] -0.1036 0.4318 0.3371 0.0501 0.685 ...
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : chr [1:18] &quot;Leptictis&quot; &quot;Dasypodidae&quot; &quot;n24&quot; &quot;Potamogalinae&quot; ...
##   ..$ : NULL</code></pre>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="the-guts-of-the-disprity-package.html#cb565-1" aria-hidden="true"></a><span class="co">## Extracting the 3rd bootstrapped matrix with the 2nd rarefaction level</span></span>
<span id="cb565-2"><a href="the-guts-of-the-disprity-package.html#cb565-2" aria-hidden="true"></a><span class="co">## (15 elements) from the second group (80 Mya)</span></span>
<span id="cb565-3"><a href="the-guts-of-the-disprity-package.html#cb565-3" aria-hidden="true"></a><span class="kw">str</span>(<span class="kw">get.matrix</span>(disparity, <span class="dt">subsets =</span> <span class="dv">1</span>, <span class="dt">bootstrap =</span> <span class="dv">3</span>, <span class="dt">rarefaction =</span> <span class="dv">2</span>))</span></code></pre></div>
<pre><code>##  num [1:15, 1:97] -0.12948 -0.57973 0.00361 0.27123 0.27123 ...
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : chr [1:15] &quot;n15&quot; &quot;Maelestes&quot; &quot;n20&quot; &quot;n34&quot; ...
##   ..$ : NULL</code></pre>
</div>
<div id="n.subsets" class="section level4 hasAnchor" number="7.2.1.4">
<h4><span class="header-section-number">7.2.1.4</span> <code>n.subsets</code><a href="the-guts-of-the-disprity-package.html#n.subsets" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This function simply counts the number of subsets in a <code>dispRity</code> object.</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="the-guts-of-the-disprity-package.html#cb567-1" aria-hidden="true"></a><span class="co">## How many subsets are in this object?</span></span>
<span id="cb567-2"><a href="the-guts-of-the-disprity-package.html#cb567-2" aria-hidden="true"></a><span class="kw">n.subsets</span>(disparity)</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
</div>
<div id="name.subsets" class="section level4 hasAnchor" number="7.2.1.5">
<h4><span class="header-section-number">7.2.1.5</span> <code>name.subsets</code><a href="the-guts-of-the-disprity-package.html#name.subsets" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This function gets you the names of the subsets in a <code>dispRity</code> object as a vector.</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="the-guts-of-the-disprity-package.html#cb569-1" aria-hidden="true"></a><span class="co">## What are they called?</span></span>
<span id="cb569-2"><a href="the-guts-of-the-disprity-package.html#cb569-2" aria-hidden="true"></a><span class="kw">name.subsets</span>(disparity)</span></code></pre></div>
<pre><code>## [1] &quot;90&quot; &quot;80&quot; &quot;70&quot; &quot;60&quot; &quot;50&quot; &quot;40&quot; &quot;30&quot;</code></pre>
</div>
<div id="size.subsets" class="section level4 hasAnchor" number="7.2.1.6">
<h4><span class="header-section-number">7.2.1.6</span> <code>size.subsets</code><a href="the-guts-of-the-disprity-package.html#size.subsets" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This function tells the number of elements in each subsets of a <code>dispRity</code> object.</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="the-guts-of-the-disprity-package.html#cb571-1" aria-hidden="true"></a><span class="co">## How many elements are there in each subset?</span></span>
<span id="cb571-2"><a href="the-guts-of-the-disprity-package.html#cb571-2" aria-hidden="true"></a><span class="kw">size.subsets</span>(disparity)</span></code></pre></div>
<pre><code>## 90 80 70 60 50 40 30 
## 18 22 23 21 18 15 10</code></pre>
</div>
<div id="get.subsets" class="section level4 hasAnchor" number="7.2.1.7">
<h4><span class="header-section-number">7.2.1.7</span> <code>get.subsets</code><a href="the-guts-of-the-disprity-package.html#get.subsets" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This function creates a dispRity object that contains only elements from one specific subsets.</p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="the-guts-of-the-disprity-package.html#cb573-1" aria-hidden="true"></a><span class="co">## Extracting all the data for the crown mammals</span></span>
<span id="cb573-2"><a href="the-guts-of-the-disprity-package.html#cb573-2" aria-hidden="true"></a>(crown_mammals &lt;-<span class="st"> </span><span class="kw">get.subsets</span>(disp_crown_stemBS, <span class="st">&quot;Group.crown&quot;</span>))</span>
<span id="cb573-3"><a href="the-guts-of-the-disprity-package.html#cb573-3" aria-hidden="true"></a></span>
<span id="cb573-4"><a href="the-guts-of-the-disprity-package.html#cb573-4" aria-hidden="true"></a><span class="co">## The object keeps the properties of the parent object but is composed of only one subsets</span></span>
<span id="cb573-5"><a href="the-guts-of-the-disprity-package.html#cb573-5" aria-hidden="true"></a><span class="kw">length</span>(crown_mammals<span class="op">$</span>subsets)</span></code></pre></div>
</div>
<div id="combine.subsets" class="section level4 hasAnchor" number="7.2.1.8">
<h4><span class="header-section-number">7.2.1.8</span> <code>combine.subsets</code><a href="the-guts-of-the-disprity-package.html#combine.subsets" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This function allows to merge different subsets.</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="the-guts-of-the-disprity-package.html#cb574-1" aria-hidden="true"></a><span class="co">## Combine the two first subsets in the dispRity data example</span></span>
<span id="cb574-2"><a href="the-guts-of-the-disprity-package.html#cb574-2" aria-hidden="true"></a><span class="kw">combine.subsets</span>(disparity, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code></pre></div>
<p>Note that the computed values (bootstrapped data + disparity metric) are not merge.</p>
</div>
<div id="get.disparity" class="section level4 hasAnchor" number="7.2.1.9">
<h4><span class="header-section-number">7.2.1.9</span> <code>get.disparity</code><a href="the-guts-of-the-disprity-package.html#get.disparity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This function extracts the calculated disparity values of a specific matrix.</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="the-guts-of-the-disprity-package.html#cb575-1" aria-hidden="true"></a><span class="co">## Extracting the observed disparity (default)</span></span>
<span id="cb575-2"><a href="the-guts-of-the-disprity-package.html#cb575-2" aria-hidden="true"></a><span class="kw">get.disparity</span>(disparity)</span>
<span id="cb575-3"><a href="the-guts-of-the-disprity-package.html#cb575-3" aria-hidden="true"></a></span>
<span id="cb575-4"><a href="the-guts-of-the-disprity-package.html#cb575-4" aria-hidden="true"></a><span class="co">## Extracting the disparity from the bootstrapped values from the</span></span>
<span id="cb575-5"><a href="the-guts-of-the-disprity-package.html#cb575-5" aria-hidden="true"></a><span class="co">## 10th rarefaction level from the second subsets (80 Mya)</span></span>
<span id="cb575-6"><a href="the-guts-of-the-disprity-package.html#cb575-6" aria-hidden="true"></a><span class="kw">get.disparity</span>(disparity, <span class="dt">observed =</span> <span class="ot">FALSE</span>, <span class="dt">subsets =</span> <span class="dv">2</span>, <span class="dt">rarefaction =</span> <span class="dv">10</span>)</span></code></pre></div>
</div>
<div id="scale.disprity" class="section level4 hasAnchor" number="7.2.1.10">
<h4><span class="header-section-number">7.2.1.10</span> <code>scale.dispRity</code><a href="the-guts-of-the-disprity-package.html#scale.disprity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is the modified S3 method for <code>scale</code> (scaling and/or centring) that can be applied to the disparity data of a <code>dispRity</code> object and can take optional arguments (for example the rescaling by dividing by a maximum value).</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="the-guts-of-the-disprity-package.html#cb576-1" aria-hidden="true"></a><span class="co">## Getting the disparity values of the time subsets</span></span>
<span id="cb576-2"><a href="the-guts-of-the-disprity-package.html#cb576-2" aria-hidden="true"></a><span class="kw">head</span>(<span class="kw">summary</span>(disparity))</span>
<span id="cb576-3"><a href="the-guts-of-the-disprity-package.html#cb576-3" aria-hidden="true"></a></span>
<span id="cb576-4"><a href="the-guts-of-the-disprity-package.html#cb576-4" aria-hidden="true"></a><span class="co">## Scaling the same disparity values</span></span>
<span id="cb576-5"><a href="the-guts-of-the-disprity-package.html#cb576-5" aria-hidden="true"></a><span class="kw">head</span>(<span class="kw">summary</span>(<span class="kw">scale.dispRity</span>(disparity, <span class="dt">scale =</span> <span class="ot">TRUE</span>)))</span>
<span id="cb576-6"><a href="the-guts-of-the-disprity-package.html#cb576-6" aria-hidden="true"></a></span>
<span id="cb576-7"><a href="the-guts-of-the-disprity-package.html#cb576-7" aria-hidden="true"></a><span class="co">## Scaling and centering:</span></span>
<span id="cb576-8"><a href="the-guts-of-the-disprity-package.html#cb576-8" aria-hidden="true"></a><span class="kw">head</span>(<span class="kw">summary</span>(<span class="kw">scale.dispRity</span>(disparity, <span class="dt">scale =</span> <span class="ot">TRUE</span>, <span class="dt">center =</span> <span class="ot">TRUE</span>)))</span>
<span id="cb576-9"><a href="the-guts-of-the-disprity-package.html#cb576-9" aria-hidden="true"></a></span>
<span id="cb576-10"><a href="the-guts-of-the-disprity-package.html#cb576-10" aria-hidden="true"></a><span class="co">## Rescaling the value by dividing by a maximum value</span></span>
<span id="cb576-11"><a href="the-guts-of-the-disprity-package.html#cb576-11" aria-hidden="true"></a><span class="kw">head</span>(<span class="kw">summary</span>(<span class="kw">scale.dispRity</span>(disparity, <span class="dt">max =</span> <span class="dv">10</span>)))</span></code></pre></div>
</div>
<div id="sort.disprity" class="section level4 hasAnchor" number="7.2.1.11">
<h4><span class="header-section-number">7.2.1.11</span> <code>sort.dispRity</code><a href="the-guts-of-the-disprity-package.html#sort.disprity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is the S3 method of <code>sort</code> for sorting the subsets alphabetically (default) or following a specific pattern.</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="the-guts-of-the-disprity-package.html#cb577-1" aria-hidden="true"></a><span class="co">## Sorting the disparity subsets in inverse alphabetic order</span></span>
<span id="cb577-2"><a href="the-guts-of-the-disprity-package.html#cb577-2" aria-hidden="true"></a><span class="kw">head</span>(<span class="kw">summary</span>(<span class="kw">sort</span>(disparity, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)))</span>
<span id="cb577-3"><a href="the-guts-of-the-disprity-package.html#cb577-3" aria-hidden="true"></a></span>
<span id="cb577-4"><a href="the-guts-of-the-disprity-package.html#cb577-4" aria-hidden="true"></a><span class="co">## Customised sorting</span></span>
<span id="cb577-5"><a href="the-guts-of-the-disprity-package.html#cb577-5" aria-hidden="true"></a><span class="kw">head</span>(<span class="kw">summary</span>(<span class="kw">sort</span>(disparity, <span class="dt">sort =</span> <span class="kw">c</span>(<span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">6</span>))))</span></code></pre></div>
</div>
<div id="get.tree-add.tree-and-remove.tree" class="section level4 hasAnchor" number="7.2.1.12">
<h4><span class="header-section-number">7.2.1.12</span> <code>get.tree</code> <code>add.tree</code> and <code>remove.tree</code><a href="the-guts-of-the-disprity-package.html#get.tree-add.tree-and-remove.tree" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>These functions allow to manipulate the potential tree components of <code>dispRity</code> objects.</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="the-guts-of-the-disprity-package.html#cb578-1" aria-hidden="true"></a><span class="co">## Getting the tree component of a dispRity object</span></span>
<span id="cb578-2"><a href="the-guts-of-the-disprity-package.html#cb578-2" aria-hidden="true"></a><span class="kw">get.tree</span>(disparity)</span>
<span id="cb578-3"><a href="the-guts-of-the-disprity-package.html#cb578-3" aria-hidden="true"></a></span>
<span id="cb578-4"><a href="the-guts-of-the-disprity-package.html#cb578-4" aria-hidden="true"></a><span class="co">## Removing the tree</span></span>
<span id="cb578-5"><a href="the-guts-of-the-disprity-package.html#cb578-5" aria-hidden="true"></a><span class="kw">remove.tree</span>(disparity)</span>
<span id="cb578-6"><a href="the-guts-of-the-disprity-package.html#cb578-6" aria-hidden="true"></a></span>
<span id="cb578-7"><a href="the-guts-of-the-disprity-package.html#cb578-7" aria-hidden="true"></a><span class="co">## Adding a tree</span></span>
<span id="cb578-8"><a href="the-guts-of-the-disprity-package.html#cb578-8" aria-hidden="true"></a><span class="kw">add.tree</span>(disparity, <span class="dt">tree =</span> BeckLee_tree)</span></code></pre></div>
<p>Note that <code>get.tree</code> can also be used to extract trees from different subsets (custom or continuous/discrete subsets).</p>
<p>For example, if we have three time bins like in the example below we have three time bins and we can extract the subtrees for these three time bins in different ways using the option <code>subsets</code> and <code>to.root</code>:</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="the-guts-of-the-disprity-package.html#cb579-1" aria-hidden="true"></a><span class="co">## Load the Beck &amp; Lee 2014 data</span></span>
<span id="cb579-2"><a href="the-guts-of-the-disprity-package.html#cb579-2" aria-hidden="true"></a><span class="kw">data</span>(BeckLee_tree) ; <span class="kw">data</span>(BeckLee_mat99) ; <span class="kw">data</span>(BeckLee_ages)</span>
<span id="cb579-3"><a href="the-guts-of-the-disprity-package.html#cb579-3" aria-hidden="true"></a></span>
<span id="cb579-4"><a href="the-guts-of-the-disprity-package.html#cb579-4" aria-hidden="true"></a><span class="co">## Time binning (discrete method)</span></span>
<span id="cb579-5"><a href="the-guts-of-the-disprity-package.html#cb579-5" aria-hidden="true"></a><span class="co">## Generate two discrete time bins from 120 to 40 Ma every 20 Ma</span></span>
<span id="cb579-6"><a href="the-guts-of-the-disprity-package.html#cb579-6" aria-hidden="true"></a>time_bins &lt;-<span class="st"> </span><span class="kw">chrono.subsets</span>(<span class="dt">data =</span> BeckLee_mat99, <span class="dt">tree =</span> BeckLee_tree,</span>
<span id="cb579-7"><a href="the-guts-of-the-disprity-package.html#cb579-7" aria-hidden="true"></a>                            <span class="dt">method =</span> <span class="st">&quot;discrete&quot;</span>, <span class="dt">time =</span> <span class="kw">c</span>(<span class="dv">120</span>, <span class="dv">100</span>, <span class="dv">80</span>, <span class="dv">60</span>),</span>
<span id="cb579-8"><a href="the-guts-of-the-disprity-package.html#cb579-8" aria-hidden="true"></a>                            <span class="dt">inc.nodes =</span> <span class="ot">TRUE</span>, <span class="dt">FADLAD =</span> BeckLee_ages)</span>
<span id="cb579-9"><a href="the-guts-of-the-disprity-package.html#cb579-9" aria-hidden="true"></a></span>
<span id="cb579-10"><a href="the-guts-of-the-disprity-package.html#cb579-10" aria-hidden="true"></a><span class="co">## Getting the subtrees all the way to the root</span></span>
<span id="cb579-11"><a href="the-guts-of-the-disprity-package.html#cb579-11" aria-hidden="true"></a>root_subsets &lt;-<span class="st"> </span><span class="kw">get.tree</span>(time_bins, <span class="dt">subsets =</span> <span class="ot">TRUE</span>)</span>
<span id="cb579-12"><a href="the-guts-of-the-disprity-package.html#cb579-12" aria-hidden="true"></a></span>
<span id="cb579-13"><a href="the-guts-of-the-disprity-package.html#cb579-13" aria-hidden="true"></a><span class="co">## Plotting the bin contents</span></span>
<span id="cb579-14"><a href="the-guts-of-the-disprity-package.html#cb579-14" aria-hidden="true"></a>old_par &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb579-15"><a href="the-guts-of-the-disprity-package.html#cb579-15" aria-hidden="true"></a><span class="kw">plot</span>(BeckLee_tree, <span class="dt">main =</span> <span class="st">&quot;original tree&quot;</span>, <span class="dt">show.tip.label =</span> <span class="ot">FALSE</span>)</span>
<span id="cb579-16"><a href="the-guts-of-the-disprity-package.html#cb579-16" aria-hidden="true"></a><span class="kw">axisPhylo</span>()</span>
<span id="cb579-17"><a href="the-guts-of-the-disprity-package.html#cb579-17" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dt">v =</span> BeckLee_tree<span class="op">$</span>root.time <span class="op">-</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">120</span>, <span class="dv">100</span>, <span class="dv">80</span>, <span class="dv">60</span>))</span>
<span id="cb579-18"><a href="the-guts-of-the-disprity-package.html#cb579-18" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) {</span>
<span id="cb579-19"><a href="the-guts-of-the-disprity-package.html#cb579-19" aria-hidden="true"></a>     <span class="kw">plot</span>(root_subsets[[i]], <span class="dt">main =</span> <span class="kw">names</span>(root_subsets)[i],</span>
<span id="cb579-20"><a href="the-guts-of-the-disprity-package.html#cb579-20" aria-hidden="true"></a>          <span class="dt">show.tip.label =</span> <span class="ot">FALSE</span>)</span>
<span id="cb579-21"><a href="the-guts-of-the-disprity-package.html#cb579-21" aria-hidden="true"></a>     <span class="kw">axisPhylo</span>()</span>
<span id="cb579-22"><a href="the-guts-of-the-disprity-package.html#cb579-22" aria-hidden="true"></a>}</span></code></pre></div>
<p><img src="dispRity_manual_files/figure-html/unnamed-chunk-210-1.png" width="672" /></p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="the-guts-of-the-disprity-package.html#cb580-1" aria-hidden="true"></a><span class="kw">par</span>(old_par)</span></code></pre></div>
<p>But we can also extract the subtrees containing only branch lengths for the actual bins using <code>to.root = FALSE</code>:</p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="the-guts-of-the-disprity-package.html#cb581-1" aria-hidden="true"></a><span class="co">## Getting the subtrees all the way to the root</span></span>
<span id="cb581-2"><a href="the-guts-of-the-disprity-package.html#cb581-2" aria-hidden="true"></a>bin_subsets &lt;-<span class="st"> </span><span class="kw">get.tree</span>(time_bins, <span class="dt">subsets =</span> <span class="ot">TRUE</span>, <span class="dt">to.root =</span> <span class="ot">FALSE</span>)</span>
<span id="cb581-3"><a href="the-guts-of-the-disprity-package.html#cb581-3" aria-hidden="true"></a></span>
<span id="cb581-4"><a href="the-guts-of-the-disprity-package.html#cb581-4" aria-hidden="true"></a><span class="co">## Plotting the bin contents</span></span>
<span id="cb581-5"><a href="the-guts-of-the-disprity-package.html#cb581-5" aria-hidden="true"></a>old_par &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb581-6"><a href="the-guts-of-the-disprity-package.html#cb581-6" aria-hidden="true"></a><span class="kw">plot</span>(BeckLee_tree, <span class="dt">main =</span> <span class="st">&quot;original tree&quot;</span>, <span class="dt">show.tip.label =</span> <span class="ot">FALSE</span>)</span>
<span id="cb581-7"><a href="the-guts-of-the-disprity-package.html#cb581-7" aria-hidden="true"></a><span class="kw">axisPhylo</span>()</span>
<span id="cb581-8"><a href="the-guts-of-the-disprity-package.html#cb581-8" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dt">v =</span> BeckLee_tree<span class="op">$</span>root.time <span class="op">-</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">120</span>, <span class="dv">100</span>, <span class="dv">80</span>, <span class="dv">60</span>))</span>
<span id="cb581-9"><a href="the-guts-of-the-disprity-package.html#cb581-9" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) {</span>
<span id="cb581-10"><a href="the-guts-of-the-disprity-package.html#cb581-10" aria-hidden="true"></a>     <span class="kw">plot</span>(bin_subsets[[i]], <span class="dt">main =</span> <span class="kw">names</span>(bin_subsets)[i],</span>
<span id="cb581-11"><a href="the-guts-of-the-disprity-package.html#cb581-11" aria-hidden="true"></a>          <span class="dt">show.tip.label =</span> <span class="ot">FALSE</span>)</span>
<span id="cb581-12"><a href="the-guts-of-the-disprity-package.html#cb581-12" aria-hidden="true"></a>     <span class="kw">axisPhylo</span>()</span>
<span id="cb581-13"><a href="the-guts-of-the-disprity-package.html#cb581-13" aria-hidden="true"></a>}</span></code></pre></div>
<p><img src="dispRity_manual_files/figure-html/unnamed-chunk-211-1.png" width="672" /></p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="the-guts-of-the-disprity-package.html#cb582-1" aria-hidden="true"></a><span class="kw">par</span>(old_par)</span></code></pre></div>
<p>This can be useful for example for calculating the branch lengths in each bin:</p>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="the-guts-of-the-disprity-package.html#cb583-1" aria-hidden="true"></a><span class="co">## How many cumulated phylogenetic diversity in each bin?</span></span>
<span id="cb583-2"><a href="the-guts-of-the-disprity-package.html#cb583-2" aria-hidden="true"></a><span class="kw">lapply</span>(bin_subsets, <span class="cf">function</span>(tree) <span class="kw">sum</span>(tree<span class="op">$</span>edge.length))</span></code></pre></div>
<pre><code>## $`120 - 100`
## [1] 189.2802
## 
## $`100 - 80`
## [1] 341.7199
## 
## $`80 - 60`
## [1] 426.7492</code></pre>
</div>
</div>
</div>
<div id="disprity-object" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> The <code>dispRity</code> object content<a href="the-guts-of-the-disprity-package.html#disprity-object" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The functions above are utilities to easily and safely access different elements in the <code>dispRity</code> object.
Alternatively, of course, each elements can be accessed manually.
Here is an explanation on how it works.
The <code>dispRity</code> object is a <code>list</code> of two to four elements, each of which are detailed below:</p>
<ul>
<li><code>$matrix</code>: an object of class <code>list</code> that contains at least one object of class <code>matrix</code>: the full multidimensional space.</li>
<li><code>$call</code>: an object of class <code>list</code> containing information on the <code>dispRity</code> object content.</li>
<li><code>$subsets</code>: an object of class <code>list</code> containing the subsets of the multidimensional space.</li>
<li><code>$disparity</code>: an object of class <code>list</code> containing the disparity values.</li>
</ul>
<p>The <code>dispRity</code> object is loosely based on <code>C</code> structure objects.
In fact, it is composed of one unique instance of a matrix (the multidimensional space) upon which the metric function is called via “pointers” to only a certain number of elements and/or dimensions of this matrix.
This allows for: (1) faster and easily tractable execution time: the metric functions are called through apply family function and can be parallelised; and (2) a really low memory footprint: at any time, only one matrix (or list of matrices) is present in the <code>R</code> environment rather than multiple copies of it for each subset.</p>
<div id="matrix" class="section level3 hasAnchor" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> <code>$matrix</code><a href="the-guts-of-the-disprity-package.html#matrix" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is the multidimensional space, stored in the <code>R</code> environment as a <code>list</code> object containing one or more <code>matrix</code> objects.
Each <code>matrix</code> requires row names but not column names (optional).
By default, if the row names are missing, <code>dispRity</code> function will arbitrarily generate them in numeric order (i.e. <code>rownames(matrix) &lt;- 1:nrow(matrix)</code>).
This element of the <code>dispRity</code> object is never modified.</p>
</div>
<div id="call" class="section level3 hasAnchor" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> <code>$call</code><a href="the-guts-of-the-disprity-package.html#call" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This element contains the information on the <code>dispRity</code> object content.
It is a <code>list</code> that can contain the following:</p>
<ul>
<li><code>$call$subsets</code>: a vector of <code>character</code> with information on the subsets type (either <code>"continuous"</code>, <code>"discrete"</code> or <code>"custom"</code>), their eventual model (<code>"acctran"</code>, <code>"deltran"</code>, <code>"random"</code>, <code>"proximity"</code>, <code>"equal.split"</code>, <code>"gradual.split"</code>) and eventual information about the trees and matrices used through <code>chrono.subsets</code>. This element generated only once via <code>chrono.subsets()</code> and <code>custom.subsets()</code>.</li>
<li><code>$call$dimensions</code>: either a single <code>numeric</code> value indicating how many dimensions to use or a vector of <code>numeric</code> values indicating which specific dimensions to use. This element is by default the number of columns in <code>$matrix</code> but can be modified through <code>boot.matrix()</code> or <code>dispRity()</code>.</li>
<li><code>$call$bootstrap</code>: this is a <code>list</code> containing three elements:
<ul>
<li><code>[[1]]</code>: the number of bootstrap replicates (<code>numeric</code>)</li>
<li><code>[[2]]</code>: the bootstrap method (<code>character</code>)</li>
<li><code>[[3]]</code>: the rarefaction levels (<code>numeric</code> vector)</li>
</ul></li>
<li><code>$call$disparity</code>: this is a <code>list</code> containing one element, <code>$metric</code>, that is a <code>list</code> containing the different functions passed to the <code>metric</code> argument in <code>dispRity</code>. These are <code>call</code> elements and get modified each time the <code>dispRity</code> function is used (the first element is the first metric(s), the second, the second metric(s), etc.).</li>
</ul>
</div>
<div id="subsets" class="section level3 hasAnchor" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> <code>$subsets</code><a href="the-guts-of-the-disprity-package.html#subsets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This element contain the eventual subsets of the multidimensional space.
It is a <code>list</code> of subset names.
Each subset name is in turn a <code>list</code> of at least one element called <code>elements</code> which is in turn a <code>matrix</code>.
This <code>elements</code> matrix is the raw (observed) elements in the subsets.
The <code>elements</code> matrix is composed of <code>numeric</code> values in one column and <em>n</em> rows (the number of elements in the subset).
Each of these values are a “pointer” (<code>C</code> inspired) to the element of the <code>$matrix</code>.
For example, lets assume a <code>dispRity</code> object called <code>disparity</code>, composed of at least one subsets called <code>sub1</code>:</p>
<pre><code> disparity$subsets$sub1$elements
      [,1]
 [1,]    5
 [2,]    4
 [3,]    6
 [4,]    7</code></pre>
<p>The values in the matrix “point” to the elements in <code>$matrix</code>: here, the multidimensional space with only the 4th, 5th, 6th and 7th elements.
The following elements in <code>diparity$subsets$sub1</code> will correspond to the same “pointers” but drawn from the bootstrap replicates.
The columns will correspond to different bootstrap replicates.
For example:</p>
<pre><code> disparity$subsets$sub1[[2]]
      [,1] [,2] [,3] [,4]
 [1,]   57   43   70    4
 [2,]   43   44    4    4
 [3,]   42   84   44    1
 [4,]   84    7    2   10</code></pre>
<p>This signifies that we have four bootstrap pseudo-replicates pointing each time to four elements in <code>$matrix</code>.
The next element (<code>[[3]]</code>) will be the same for the eventual first rarefaction level (i.e. the resulting bootstrap matrix will have <em>m</em> rows where <em>m</em> is the number of elements for this rarefaction level).
The next element after that (<code>[[4]]</code>) will be the same for with an other rarefaction level and so forth…</p>
<p>When a probabilistic model was used to select the elements (models that have the <code>"split"</code> suffix, e.g. <code>chrono.subsets(..., model = "gradual.split")</code>), the <code>$elements</code> is a matrix containing a pair of elements of the matrix and a probability for sampling the first element in that list:</p>
<pre><code> disparity$subsets$sub1$elements
      [,1] [,2]       [,3]
 [1,]   73   36 0.01871893
 [2,]   74   37 0.02555876
 [3,]   33   38 0.85679821</code></pre>
<p>In this example, you can read the table row by row as: “there is a probability of <code>0.018</code> for sampling element <code>73</code> and a probability of <code>0.82</code> (<code>1-0.018</code>) of sampling element <code>36</code>”.</p>
</div>
<div id="disparity" class="section level3 hasAnchor" number="7.3.4">
<h3><span class="header-section-number">7.3.4</span> <code>$disparity</code><a href="the-guts-of-the-disprity-package.html#disparity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>$disparity</code> element is identical to the <code>$subsets</code> element structure (a list of list(s) containing matrices) but the matrices don’t contain “pointers” to <code>$matrix</code> but the disparity result of the disparity metric applied to the “pointers”.
For example, in our first example (<code>$elements</code>) from above, if the disparity metric is of dimensions level 1, we would have:</p>
<pre><code> disparity$disparity$sub1$elements
      [,1]
 [1,]    1.82</code></pre>
<p>This is the observed disparity (1.82) for the subset called <code>sub1</code>.
If the disparity metric is of dimension level 2 (say the function <code>range</code> that outputs two values), we would have:</p>
<pre><code> disparity$disparity$sub1$elements
      [,1]
 [1,]    0.82
 [2,]    2.82</code></pre>
<p>The following elements in the list follow the same logic as before: rows are disparity values (one row for a dimension level 1 metric, multiple for a dimensions level 2 metric) and columns are the bootstrap replicates (the bootstrap with all elements followed by the eventual rarefaction levels).
For example for the bootstrap without rarefaction (second element of the list):</p>
<pre><code> disparity$disparity$sub1[[2]]
         [,1]     [,2]     [,3]     [,4]
[1,] 1.744668 1.777418 1.781624 1.739679 </code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="other-functionalities.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="disprity-ecology-demo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/TGuillerme/dispRity/inst/gitbook/edit/master/06_guts.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
